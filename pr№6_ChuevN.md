# Практическая работа № 6

**Выполнил:** Чуев Никита Сергеевич  
**Группа:** P4150  
**Преподаватель:** Васильев Дмитрий Евгеньевич  
**Дата выполнения задания:** 02.06.2025  
**Название дисциплины:** "Сети и протоколы"  

## Задание

Задача
Задание 

Реализовать анализатор сети (на наличие указанной атаки/ уязвимости при помощи языка Python. 

(Для реализации можете использовать что угодно, советую использовать библиотеку Scapy)

1. Нужно найти скрипт атаки/ либо написать самостоятельно, инструменты на ваш выбор. 

2. Написать анализатор сети, который будет захватывать данные в локальной сети, их анализировать и выводить уведомление в консоль, если произошла аномалия.


### Атака DNS spuffing

## скрипт:
Practic№6/dns_spoofer.py 
## Вывод терминала :

Microsoft Windows [Version 10.0.26100.4061]
(c) Корпорация Майкрософт (Microsoft Corporation). Все права защищены.

C:\Users\NikitaShuyiv\Desktop\ITNO\2_семестр\сети и протоколы\ChuevN_Networks\Practic№6>python dns_spoofer.py
C:\Users\NikitaShuyiv\AppData\Local\Programs\Python\Python313\Lib\site-packages\scapy\sendrecv.py:479: SyntaxWarning: 'iface' has no effect on L3 I/O send(). For multicast/link-local see https://scapy.readthedocs.io/en/latest/usage.html#multicast
  warnings.warn(
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6
[!] Отправлен поддельный DNS ответ: example.local -> 6.6.6.6


### анализатор сети
## скрипт:
Practic№6/dns_analyzer.py

## Вывод терминала

Microsoft Windows [Version 10.0.26100.4061]
(c) Корпорация Майкрософт (Microsoft Corporation). Все права защищены.

C:\Users\NikitaShuyiv\Desktop\ITNO\2_семестр\сети и протоколы\ChuevN_Networks\Practic№6>python dns_analyzer.py
[*] Запуск сниффера DNS на интерфейсе Loopback...

[2025-06-02 15:55:04] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[!!!] Подозрение на DNS Spoofing:
  Ожидалось: 127.0.0.1
  Получено : 6.6.6.6

[2025-06-02 15:55:06] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:08] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:10] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:12] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:14] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:16] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:18] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:20] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:22] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:24] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:26] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:28] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:30] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

[2025-06-02 15:55:32] DNS-ответ:
  • Домен : example.local
  • IP     : 6.6.6.6
  • TTL    : 60
  • Ранее замеченные IP: 6.6.6.6

### Выводы по работе

Анализатор на Python, основанный на библиотеке Scapy, захватывал DNS-пакеты, сравнивал полученный IP с ожидаемым и при обнаружении несоответствия выводил предупреждение.
В результате было подтверждено, что анализатор корректно детектирует подделанные ответы и информирует пользователя о подозрительных событиях. 